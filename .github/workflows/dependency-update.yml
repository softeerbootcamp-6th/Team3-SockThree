name: Dependency Update

on:
  schedule:
    - cron: '0 2 * * 1' # ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 2ì‹œ
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  update-dependencies:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}

    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'

    - name: Update Gradle dependencies
      run: |
        cd server
        ./gradlew dependencyUpdates

    - name: Update npm dependencies
      run: |
        cd client
        npx npm-check-updates -u
        npm install

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v5
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: 'â¬†ï¸ Update dependencies'
        title: 'â¬†ï¸ Weekly dependency update'
        body: |
          ## ğŸ“¦ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸

          ìë™ìœ¼ë¡œ ìƒì„±ëœ ì˜ì¡´ì„± ì—…ë°ì´íŠ¸ PRì…ë‹ˆë‹¤.

          ### ë³€ê²½ì‚¬í•­
          - Backend (Gradle) ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
          - Frontend (npm) ì˜ì¡´ì„± ì—…ë°ì´íŠ¸

          ### í™•ì¸ì‚¬í•­
          - [ ] í…ŒìŠ¤íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ í†µê³¼í•˜ëŠ”ì§€ í™•ì¸
          - [ ] Breaking changesê°€ ìˆëŠ”ì§€ í™•ì¸
          - [ ] ë³´ì•ˆ ì·¨ì•½ì ì´ í•´ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸
        branch: dependency-updates
        delete-branch: true
